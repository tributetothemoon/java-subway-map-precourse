# 프리코스 3주차 개발 노트

3주차 과제에 관한 개발노트입니다. 무슨 생각과 고민을 했는지, 주안점을 둔 것은 무엇인지, 진행 후 회고 등을 자유롭게 서술합니다.

------------------------------

## 🌗2주차 프리코스 회고

2주차 과제를 제출하고, 다시 코드를 살펴보며 아쉬운 점들을 생각하고 다음엔 개선하리라 생각했던 점이 몇가지 있습니다.

#### 1. 하드코딩 주의
피드백에 누차 강조해주셨던 내용인만큼 철저하게 지키려고 노력했으나, 제출하고 보니 무심결에 인스턴스 변수를 원시값 int 0으로 초기화한 것을 보았습니다.
가능한 상수화를 하지 않고도 값을 작성할 수 있는지, 그렇지 않다면 상수화를 하여 하드코딩을 피할 수 있도록 노력했습니다.

#### 2. 내부로직 private 접근 제어자 사용 철저화
클래스 내부에서만 사용되는 로직임에도 public으로 작성하는 실수를 몇개 범해 캡슐화를 철저히 지키지 못했었습니다. 이번에는 같은 실수를 하지 않으려 노력했습니다.

#### 3. 사용자 정의 예외 만들기
필요할 때 예외를 발생시킨다는 것과 메세지를 첨부한다는 것에 몰두해 예외를 IllegalArgumentException에 의존했습니다.
이번엔 발생할 수 있는 예외들을 정리하고 스스로 예외 클래스들을 작성해보았습니다.

#### 4. Stream 남발 주의
Stream의 편리함에 빠져 for문을 잊고 살다 시피 했습니다.
성능적으로도 그렇고 경우에 따라 가독성도 해칠 우려가 있기 때문에, 무엇이 더 적절한지 의식하도록 노력했습니다.

------------------------------
## 🎏3주차 진행 주안점


### 🏬의존성 설계

### `기본 패턴`
<div>
    <img src="https://user-images.githubusercontent.com/49346677/102109941-f22d0880-3e77-11eb-90c7-05cfc3740343.png" width="80%">
</div>

- 양방향 의존성이 발생하지 않도록 하고, 또한 의존성 측면에서 계층화 될 수 있도록 노력했습니다.
- 컨트롤러는 도메인과 뷰를 호출하고, 역 방향은 일어나지 않습니다.

### `컨트롤러`
<div>
    <img src="https://user-images.githubusercontent.com/49346677/102105751-1c2ffc00-3e73-11eb-816c-c396137ceb5f.jpg" width="50%">
</div>

- 프로그램 실행 직 후 MainController가 실행되었을 때 로직입니다. 유저가 역/노선/구간 관리 기능을 선택한다면 해당 컨트롤러에게 제어를 넘기는 방식입니다.
- 여기서 의존성의 방향은 위의 그림과 같이 오직 MainController에서 이상 3개의 컨트롤러로만 이루어집니다.

### `뷰`

<div>
    <img src="https://user-images.githubusercontent.com/49346677/102105752-1c2ffc00-3e73-11eb-8666-8fca321e503a.jpg" width="70%">
</div>

- 처음엔 Input/Output View만 설정하고 진행했으나, 각각의 메뉴에 따른 문자열 상수, 비슷한 로직의 서로 다른 메소드들(e.g., 역/노선/구간 -> 각각 등록, 삭제 메소드가 존재)이 쌓여만 가면서 점점 In/OutputView가 비대해지는 문제가 생겨 역/노선/관리 기능에 따라 컨트롤러뿐만이 아닌 View 역시도 독립적으로 가지도록 분리했습니다. 이 View들은 싱글톤으로 생성됩니다.

- 이 과정에서 Controller가 자신과 매칭되는 View 뿐 아니라 상황에 따라 InputView와 OutputView를 사용해야 하는 상황이 발생하니, View들의 역할도 모호하고 프로그램을 만드는 입장에서도 어디에 어떤 함수가 있었는지를 이렇다 할 기준 없이 알고있어야하는 상황이 발생했습니다.

- 따라서 각각의 컨트롤러는 스스로와 매칭되는 뷰를 참조하는 것만으로 필요한 로직을 수행할 수 있도록 했습니다.

- In/OutputView는 유저에게 가장 가까운 곳에서, 직접적으로 문자열을 입력받거나 출력하는 가장 low한 역할을 합니다.
- 그리고 각각의 컨트롤러에 매칭되는 MenuView객체들은 직접 시스템에 출력 요청(Syetem.out.print 등)을 하거나 직접 시스템으로부터 raw스트링을 입력(Scanner 사용 등)받지 않고, Input/OutputView를 통해 진행하므로써 계층화를 유도했습니다.

- 이 과정에서, 다른 계층과의 양방향 참조나 같은 계층에서의 참조가 일어나지 않도록 의존성 설계를 진행했습니다.

------------------------------
### 🍡공통 로직 묶기

다만 이 과정에서 공통 로직의 함수가 각각의 뷰에 존재해야하기에 중복되는 코드의 양이 많아지는 단점 또한 생겨났습니다.
점점 코드의 복사, 붙여넣기로 해결할 수 있는 기능이 많아지자 심각하게 잘못되어가고 있다는 것을 직감했습니다. 따라서 상속을 통해 코드를 재사용하여 반복을 없애고자 하였습니다.
<div>
    <img src="https://user-images.githubusercontent.com/49346677/102110370-6798d900-3e78-11eb-9213-0645e4e60a1e.png" width="60%">
</div>

- 유사도가 가장 높은 역/노선/구간 관리 메뉴 로직부터 추상 클래스 ManagementView를 만들어 묶었습니다.
- 여전히 비슷한듯 다른 메인 메뉴가 있으나, 선택지의 성격이 다르기에 서로 다른 메뉴 타입을 컨트롤러에게 리턴하고 있다는 점이 다소 까다로웠습니다.
  역/노선/관리 기능은 CRUD의 성격을 띄어 ManagementMenuType란 enum 객체를(CREATE/DELETE/READ/ESCAPE), 메인메뉴는 각 관리 기능의 이름(MainMenuType.STATION/LINE/SECTION/PRINT/ESCAPE)과 노선도 출력이라는 값을 유저의 선택에 따라 리턴하고 있었기 때문입니다.
- 따라서 MenuView라는 추상 제네릭 클래스를 생성하여 모든 메뉴를 묶고, Management는 MenuView를 상속하며 ManagementMenuType을 이용할 것을 명시했습니다.

------------------------------
## 🙏스스로 느낀 한계점

### 1. 다양한 디자인 패턴을 직접 구현해보며 경험해볼 필요가 있다.

1, 2주차 프리코스 미션보다 조금 더 복잡해지자 어떻게 설계를 하는 것이 좋을지 막막해지는 것을 느꼈습니다. 만일 제가 더 다양한 패턴을 공부하고 직접 구현해보았던 경험이 있었다면, 프로그램 요구 사항을 보고 더 나은 설계를 떠올리고, 또한 만들어가면서 부딪혔던 시행착오에서 더 나은 설계를 고안할 수 있었지 않았을까라는 생각이 들었습니다.

이런 저런 시행착오를 거쳐오면서 수정 전에는 분명 여러가지 생각을 하고, 진행하는 것이 낫다고 생각하여 실행했지만, 시간이 지나면 또 더 나은 구조가 떠오르고, 다시 수정하는 루틴이 반복되었습니다. 그럴 때면 항상, 좋은 설계를 떠올릴 수 있는 능력은 정말 중요하다는 것을 느꼈습니다.


### 2. 역시나 다시, 단일 책임 원칙

프로그램이 커져갈수록 단일 책임 원칙을 지키기가 어려운 것이 느껴졌습니다. 점점 하나의 객체가 수행하는 역할이 많아지거나, 혹은 새로 만든 클래스가 다른 클래스와의 역할과 책임에서 구분이 모호해지는 것 같다는 느낌이 들었습니다. 어떠한 기능이 있을 때, 그에 대한 객체들의 협력도를 유연하게 잘 그려내는 것은 역시나 쉬운 일이 아니라는 것을 느꼈습니다.


### 3. 자바 프로그래밍 능력

선술했던 것처럼, View를 상속을 하는 과정에서 제네릭 클래스를 정의할 때나, 뷰에서 입력값에 따라 유저가 어떤 메뉴를 선택했는지에 대한 정보를 컨트롤러에 넘겨주기 위해 어떤 타입의 어떤 값을 넘겨주는 것이 적절한지 고민하다가 enum 클래스를 만들고 사용했을 때 자바를 능숙하게 다루지 못해서 오는 답답함이 느껴졌습니다.

자바를 잘 다루는 사람이라면 별 것 아닌 수준의 코드기에 바로 떠올렸을수도 있지만, 전 어떠한 문제에 부딪히고 방법이 없을까 고민하며 생각해낸 방법이었습니다. 심지어 지금도 더 좋은 방법이 있을 것이라는 회의감이 들곤 합니다. 자바에 자신이 없었던 만큼, 프리코스 합격 발표가 난 후 다시 입문서를 펼쳐보았지만, 역시나 부족했던 것 같습니다.

### 4. 그럼에도 중복되는 코드는 남아있다.

<div>
    <img src="https://user-images.githubusercontent.com/49346677/102211110-7d5cdb80-3f16-11eb-83a0-27b0f95370f3.png" width="60%">

</div>
<div>
    <img src="https://user-images.githubusercontent.com/49346677/102211130-851c8000-3f16-11eb-96cd-fa9f369bb1b7.png" width="60%">
</div>
위 두 개는 역/노선 관리 컨트롤러의 초기화 블럭입니다.

<div>
    <img src="https://user-images.githubusercontent.com/49346677/102211188-99f91380-3f16-11eb-81c3-b293106d475e.png" width="60%">
</div>
위 코드는 Station/Line View 객체를 생성하는 코드의 일부인데, 정확히 같습니다.

코드의 중복 문제는 위에서도 다루었지만, 많이 줄였다고 생각했는데도 여전히 눈엣가시처럼 많이 남아있습니다. 새삼 저의 부족함을 느낄 수 있는 부분입니다.

### 5. 테스트 코드 활용, TDD 방법론

저는 TDD에 대해서 잘 알지 못합니다. 1, 2주차에 test 코드를 작성해보고 응용해보려 했지만, 역시나 의미있게 활용한다는 느낌을 받지 못했었습니다.

그러나 이번 과제를 하며 절감한 것인데, 계속해서 프로그램이 커져 가고, 계속해서 수정이 이루어지는 마당에 언제까지나 디버거에 의존하면서만 만들 수는 없는 노릇이라는 생각이 들었습니다. 따라서 TDD에 대해서 공부해보고 직접 활용하는 경험을 쌓아야겠다는 생각이 들었습니다.
